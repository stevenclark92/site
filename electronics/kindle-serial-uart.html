<!DOCTYPE html>

<html lang="en-GB">
<head>
  <!-- Meta -->
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/assets/css/style.css?v=">
  <!-- Icon stack -->
          <meta name="msapplication-TileColor" content="#FFF" />
        <meta name="theme-color" content="#FFF" />
        <link rel="apple-touch-icon" sizes="57x57" href="/assets/favicon/apple-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="60x60" href="/assets/favicon/apple-icon-60x60.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="/assets/favicon/apple-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="76x76" href="/assets/favicon/apple-icon-76x76.png" />
        <link rel="apple-touch-icon" sizes="120x120" href="/assets/favicon/apple-icon-120x120.png" />
        <link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-icon-152x152.png" />
        <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-icon-180x180.png" />
        <link rel="icon" type="image/png" href="/assets/favicon/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="/assets/favicon/android-icon-36x36.png" sizes="36x36" />
        <link rel="icon" type="image/png" href="/assets/favicon/android-icon-48x48.png" sizes="48x48" />
        <link rel="icon" type="image/png" href="/assets/favicon/android-icon-72x72.png" sizes="72x72" />
        <link rel="icon" type="image/png" href="/assets/favicon/android-icon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="/assets/favicon/android-icon-144x144.png" sizes="144x144" />
        <link rel="icon" type="image/png" href="/assets/favicon/android-icon-192x192.png" sizes="192x192" />
        <link rel="icon" type="image/png" href="/assets/favicon/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="/assets/favicon/favicon-16x16.png" sizes="16x16" />
        <meta name="msapplication-TileImage" content="/assets/favicon/ms-icon-144x144.png" />
        <meta name="msapplication-square70x70logo" content="/assets/favicon/ms-icon-70x70.png" />
        <meta name="msapplication-square150x150logo" content="/assets/favicon/ms-icon-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="/assets/favicon/ms-icon-310x150.png" />
        <meta name="msapplication-square310x310logo" content="/assets/favicon/ms-icon-310x310.png" />
        <link href="/assets/favicon/apple-startup-320x460.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-640x920.png" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-640x1096.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-748x1024.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 1) and (orientation: landscape)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-750x1024.png" media="" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-750x1294.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-768x1004.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 1) and (orientation: portrait)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-1182x2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-1242x2148.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-1496x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" rel="apple-touch-startup-image" />
        <link href="/assets/favicon/apple-startup-1536x2008.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" rel="apple-touch-startup-image" />
        <link rel="manifest" href="/assets/favicon/manifest.json" />
  <!-- Site title & meta -->
  <title>Communicating with a Bricked Kindle Voyage over Serial/UART | steveclark.io</title>
  <!-- TODO metadesc -->
</head>

<body class="dark:bg-zinc-800 dark:text-slate-50">
  <header class="lg:fixed max-lg:flex max-xl:items-baseline p-8 lg:top-10 lg:left-10 font-light">
  <p id="logo-mb" class="text-2xl">
    <a class="max-xl:hidden" href="https://steveclark.io/">steveclark<span class="text-yellow-400">.</span>io
    </a>
    <a class="xl:hidden" href="https://steveclark.io/">sc<span class="text-yellow-400">.</span>io
    </a>
  </p>
  <nav class="*:py-1 lg:*:mt-4 max-lg:*:flex max-lg:flex justify-between w-full">
    <ul class="lg:*:mt-2">
      <li><span class="text-yellow-400 mr-1 max-lg:ml-2">/</span><a href="/notes">notes</a></li>
      <li><span class="text-yellow-400 mr-1 max-lg:ml-2">/</span><a href="/projects">projects</a></li>
      <li><span class="text-yellow-400 mr-1 max-lg:ml-2">/</span><a href="/">about</a></li>
    </ul>
    <ul class="lg:*:mt-2 max-sm:hidden">
      <li><span class="text-blue-400 mr-1 max-lg:ml-2">|</span><a href="https://github.com/stevenclark92" target="_blank">github</a></li>
      <li><span class="text-blue-400 mr-1 max-lg:ml-2">|</span><a href="https://www.linkedin.com/in/stevenjc/" target="_blank">linkedin</a></li>
    </ul>
  </nav>
</header>
  <main class="lg:m-10 p-8">
    <!-- TODO: Refactor -->
    <div
      class="mx-auto prose prose-a:font-normal prose-a:decoration-1 prose-h1:font-bold prose-h2:font-medium dark:prose-invert mb-6"
    >
      <div class="categories flex justify-between align-top mb-4">
  <p class="m-0 align">
    Posted on
    <span class="font-semibold">May  4, 2024</span> in
    <span
      class="text-transparent bg-clip-text bg-gradient-to-br from-blue-300 to-indigo-500 lowercase font-semibold"
    >
      @Electronics
    </span>
  </p>

  <div class="tags *:inline max-sm:hidden">
    
    <p
      class="text-transparent bg-clip-text bg-gradient-to-br from-yellow-300 to-amber-500 lowercase font-semibold"
    >
      [rK]
    </p>
    
    <p
      class="text-transparent bg-clip-text bg-gradient-to-br from-yellow-300 to-amber-500 lowercase font-semibold"
    >
      [Kindle]
    </p>
    
  </div>
</div>

<h1 class="head flex justify-between mb-4 items-baseline">Communicating with a Bricked Kindle Voyage over Serial/UART</h1>

<p>I recently purchased my fifth Amazon Kindle in twice as many years. Through a combination of disorganisation, clumsiness and forgetfulness, I find myself part of a very specific user segment: individuals who are constantly losing or breaking their devices. This certainly isn’t a critique of Kindles or a lamentation of Amazon; the majority of these replacements have been down to user blunder on my part, and the few that have passed from natural causes have only done so at the end of a reasonable number of years of service.</p>

<p>Having become adept at breaking Kindles, I found myself increasingly learning more about how to repair these devices - cobbling them back to some level of functionality, most of the time simply to last until a new device arrived. In so doing, I’ve ended up becoming quite knowledgeable about the hardware inside these devices and have developed a knack for solving most issues short of leaving a device on a bus.</p>

<p>This is going to be quite a long read, and in it, I will explore how to perform a total hardware and software diagnostic and repair of a broken Kindle Voyage. Many of these steps will be applicable to other devices for reasons that will become obvious, but I will disclaim early that <strong>this is not intended to be a guide or to act as instructions</strong>. If you choose to follow in my footsteps, <strong>on your head be any damage to your devices or statutory standing with Amazon</strong>.</p>

<p>I would like to also also state explicitly that I had no political motivation for choosing this device, nor is this intended to lambast Jeff Bezos or his organisation. My opinion is quite straightforward: I believe I should own my devices and have the freedom to do what I want with them, but I also believe Amazon should have the right to withhold support in the inevitable case I fuck something up. Let’s get into it.</p>

<h2 id="why-the-kindle-voyage">Why the Kindle Voyage?</h2>

<p>I started on this journey for a specific reason: Amazon’s Kindle Voyage - released a decade ago this year - only existed for a short window of time. Occupying a niche above the Paper White but at a price point that remained within reach of the majority of consumers, the device offered a better display, automatic brightness adjustment and a more refined design that included page turn buttons with haptic feedback. It’s universally considered one of the best e-book readers ever made, even today, and in my own subjective opinion it occupies the top spot comfortably.</p>

<p>Unfortunately for me, not long after the Voyage was released - and with only a single generation produced - it was retired from sale and replaced by the larger and more feature-filled Oasis. The Oasis was a lovely device to be sure, but with a significantly increased footprint and price, the mid-tier market was widely expected to transition to the lower-spec models following the voyage’s EOL. This did happen for the most part, but unexpectedly, the lack of a direct successor has also driven significant demand for second-hand Voyages even today in 2024. I find myself in this camp. I could shell out £300 for a scribe, or step down to the Paper white, but as a creature of habit and routine I find neither attracts me the same as my old faithful.</p>

<h2 id="the-voyage-in-context">The Voyage in Context</h2>

<p>The Kindle Voyage, like all e-book readers, is a low-end tablet computer. All e-book readers share the majority of their hardware with other portable electronic devices with screens, and the main distinction between other devices in their category is simply the type of screen being used. Other benefits that set these devices apart from peers in their cohort - such as extended battery life - are simply a function of the use of e-paper, which is extremely light on power consumption.</p>

<h3 id="hardware-considerations">Hardware Considerations</h3>

<p>E-paper displays are unable to update consistently at sub-second intervals due to their hardware configuration. There are many articles about this online, so I’ll stop short of a full explanation aside from the most relevant parts: Most LCDs used in phones and tablets have a refresh rate of 60 Hz or more, but the displays used in e-book readers (partial refresh notwithstanding) generally have a refresh rate between 0.25-4 Hz. Higher is possible, but concessions become necessary beyond this point, and I’ve yet to meet anyone who can read four pages per second and would benefit from these compromises being made. Refreshing more slowly means less power draw, which means a much longer battery life, which means smaller batteries and devices.</p>

<p>As rendering greyscale pages slowly isn’t particularly intensive from a computational standpoint, Kindles (and other e-book readers) stick to a known formula and significant hardware revisions are infrequent. Most devices released between 2012 and 2019 were extremely similar behind the bezel, and almost all of them used the exact same processor. Sure, the newer models had touch and a front light, but the heavy lifting was performed by the same Applications Processor, with only minor increases - if any - in RAM and eMMC sizes with  successive generations.</p>

<h3 id="slow-and-steady-wins-it">Slow and Steady Wins it</h3>

<p>Clearly, e-book readers are extremely simple devices from a hardware perspective, and little has changed regarding their configuration since the launch of the earliest models. Arguably, the only technology category that’s progressed more slowly than the e-book reader is the book. But then, if the fleshy technology doing the reading hasn’t changed, why would the silicon that provides the material need to continue to improve once perfected?</p>

<p>The Voyage was the top of its class during the 2010s, offering the best configuration and display while still using the Freescale/NXP i.MX6 processor. This is important, as the newer models are harder to crack and offer less freedom to developers and tinkerers like myself - for now at least.</p>

<p>The current device line-up as of 2022 represents the first significant hardware revision to Kindles since 2013, and while the processor has been sourced from a new vendor and the RAM has been doubled to 1 GB, the primary motivation for these changes appears to be the need for 64-bit architecture rather than a need for speed, as the chips in the new models are identically clocked and perform similarly in benchmarks. For all intents and purposes, a Kindle from 2012 can still accomplish the same job almost as well as one from 2022 - aside from web browsing, perhaps.</p>

<h2 id="unplanned-obsolescence">Unplanned Obsolescence</h2>

<p>As simple as e-book readers are by modern technological standards, the regular release cycle of devices isn’t simply to cash in on the populace’s desire for novelty and continued forwards progression; electronic devices have a finite lifespan, and there are some key failure points that often render these devices unusable after a decade or so of service. Even in cases where the best care possible is taken at all times, entropy sees to it that one of the following issues arises with increasing probability over time:</p>

<ul>
  <li>Lithium-ion batteries have extremely finite lifespans.</li>
  <li>eMMC has a limited number of write cycles.</li>
  <li>USB connectors fail, as do solder joints.</li>
  <li>Liquid and dust cause corrosion and shorts.</li>
  <li>People like me get a bit brave and “brick” them by deleting or corrupting firmware.</li>
  <li>People unlike me “brick” them in the process of following standard update procedures…</li>
  <li>Software developers tire of porting code to legacy components and sunset perfectly capable devices in favour of supporting the newer, shinier versions.</li>
</ul>

<p>Sure, it’s possible to fix some of these, but diagnostics is hard, and no two devices have the same issues. Repackaging the same processor and adding a couple extra features at intervals that roughly align with the expected end-of-life of legacy devices is easy, profitable, and arguably drives more innovation in the category.</p>

<p>Benefits notwithstanding, it’s a crying shame from an environmental standpoint - an e-book reader from 2014 has virtual feature parity with one from 2021, but due to these failure points, the former can be found in droves on eBay for pennies (and probably in greater numbers still in drawers and landfills) while the latter commands the same price as it did a decade ago for almost the same technology.</p>

<p>Obviously, a product has greater value than the sum cost of its hardware, but I’m not concerned with that for the purpose of this project. I’m not questioning the value of the device, nor do I have a strong opinion in either direction. It’s worth what people are willing to pay. As it turns out, I was willing to pay £20 and three weekends of my life spent descending yet deeper into madness. Go figure.</p>

<h2 id="the-hardware">The Hardware</h2>

<p>The Kindle Voyage’s architecture is virtually identical to the current Kindle’s configuration, but with the same pixel density as the newer Oasis. It’s certainly not as powerful as the Oasis, which features an NXP i.MX7 Dual Core chip, but it’s most definitely not a slouch by e-reader standards, nor is it particularly far behind today’s flagships. The Voyage features:</p>

<ul>
  <li>
    <p>A Freescale Semiconductor <a href="http://www.freescale.com/docs/pcn_attachments/16116_IMX6SLCEC.pdf">MCIMX6L8DVN10AB</a> Applications Processor, with a single core clocked at 1GHz.</p>
  </li>
  <li>
    <p>4 GB (32 Gb) of Toshiba <a href="http://datasheet.octopart.com/THGBM5G5A1JBAIR-Toshiba-datasheet-14049752.pdf">THGBM5G5A1JBAIR</a>  eMMC NAND Flash.</p>
  </li>
  <li>
    <p>512 MB (4 Gb) of Samsung K4P4G324EQ-RGC2 LPDDR2 SDRAM.</p>
  </li>
  <li>
    <p>A Texas Instruments <a href="http://www.ti.com/product/drv2667">DRV2667</a> Piezo Haptic Driver.</p>
  </li>
</ul>

<p>– Include Reference Architecture –</p>

<p>The NXP i.MX processors are ARM-based SoCs designed for low-power mobile devices. They’re not the fastest options, being based on the [ARM CORTEX SOMETHING], but they’re full-featured processors that are well suited for this application. 512 MB of RAM sounds tiny compared to a phone or laptop, but considering the device spends the majority of its waking time gently cycling through pages of monochrome text, there’s little need for more. Even the fairly limited storage space provides ample capacity for thousands of e-books, with even the current flagship model only offering 8 GB of storage a decade later (and the exact same amount of RAM…).</p>

<h3 id="usb-otg">USB OTG</h3>

<p>Modern USB standards are - and I do not say this lightly - a fucking mess, and the journey that led us to our current state of peripheral connecting chaos was in part paved by the ubiquitous use of Micro USB across tablets and mobile devices in the 2010s. All Kindles before 2022 made use of Micro USB, implemented with an additional, non-standard-but-widely-accepted protocol known as USB OTG, or USB On The Go. This was extremely common for mobile phones and tablets of this era, but it did come as a surprise when looking under the shell of the device, as it was barely - if ever - used.</p>

<p>USB OTG ports have five pins in place of the typical four, with the status of the additional ‘Sense’ pin being used to select whether the device should act as host or device. A floating ‘Sense’ pin - the default when using a non-OTG cable - will render service to the machine on the other end as a peripheral. Pulling this pin to ground by shorting the Sense and Ground pins inside the connector will instead inform the device that it should act as the host and expect a peripheral to be attached through the port. I hope you like dongles, because there are many where this is headed.</p>

<p>The Kindle Voyage and the 7th Generation Paperwhite both made away with built-in headphone ports, as was the style at the time. In order to continue to be able to provide audio output, they were shipped with USB to 3.5mm dongles that made use of this OTG protocol to inform the kindle that it should output audio via its USB port. As far as I know, this functionality wasn’t used beyond this single adapter, but the beauty of this near-standard is that with a few tweaks of software <strong>it most certainly can be.</strong> More on this later.</p>

<h2 id="the-software">The Software</h2>

<p>Kindle’s operating system is a Linux flavour with a lot of overlap with Android. Following power on, the device is bootstrapped with Das U-Boot which hands off to the Linux kernel, which loads the Kindle’s desktop environment and applications. Drilling into it further, it’s quite an interesting set up - and one that makes a lot of sense given the application.</p>

<p>Rather than having a single, fully-fledged u-boot instance (that would take longer to load - potentially 10 seconds from pushing the button to the desktop), Kindles have two instances installed. At boot, an extremely stripped back build handles the bare essentials - interfacing with the low-level hardware and pointing to the right addresses for the kernel to take over - but with a hidden option, called BIST, behind which hides a complete u-boot environment. This environment also includes an implementation of Fastboot, which those familiar with Android debugging will be familiar with, enabling more extensive debugging via USB from a computer.</p>

<p>https://www.embeddedartists.com/wp-content/uploads/2020/11/iMX_Boot_Times.pdf</p>

<h2 id="communicating-with-the-device">Communicating with the Device</h2>

<p>UART 1.8v
Minicom
Root password</p>

<p>UBOOT</p>

<p>NAND Sectors going bad
Making it worse by erasing the whole thing</p>

<p>BIST
FASTBOOT</p>

<p>Flashing back onto the NAND
Bad sectors preventing a complete transfer of the BIST image
Nice boot loop bro</p>

<p>Clearly, this is an unwinnable situation and something more drastic needs done:</p>

<h2 id="replacing-the-problematic-nand-chip">Replacing the Problematic NAND Chip</h2>

<p>BGA soldering is a right PITA.</p>
<ul>
  <li>lots of flux</li>
  <li>don’t let it not have flux at any point</li>
  <li>hotter than you think you need to go</li>
  <li>wait longer than you think you should</li>
  <li>don’t pull, let it come off on its own. Gentle pressure at MOST</li>
  <li>ventilate</li>
</ul>

<p>Even being careful you will probably lose pads. Fortunately, these are (most often) NC pads, which have less copper holding them to the board. I lost two myself. If you lose a vital pad it’s game over so make sure you work slowly.</p>

<p>The board seems to have survived its ordeal…</p>

<p>New NAND!</p>

<h2 id="getting-back-into-fastboot">Getting back into Fastboot</h2>

<p>Using the i.MX USB tool to patch firmware into RAM</p>

<h2 id="back-to-a-functioning-kindle">Back to a Functioning Kindle</h2>

<p>Restoring original functionality</p>

<h2 id="adding-some-new-functionality">Adding some new functionality</h2>

<p>Original is boring, let’s get a full Linux distro on it.</p>

<h2 id="whats-next">What’s next?</h2>



    </div>
  </main>

  <footer
    class="fixed text-xs bg-inherit rounded-md text-zinc-500 bottom-0 left-0"
  >
    <p class="p-2 lg:m-16">© Steve Clark 2024</p>
  </footer>


</body>
</html>